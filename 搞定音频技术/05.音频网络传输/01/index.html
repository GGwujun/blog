<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog/umi.css" />
    <script>
      window.routerBase = "/blog";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>09｜音频编解码器是如何工作的？</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/搞定音频技术/05.音频网络传输/01" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></span><span>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></span><span>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a aria-current="page" class="active" href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></span><span>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></span><span>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></span><span>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></span><span>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></span><span>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></li><li>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></li><li>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a aria-current="page" class="active" href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></li><li>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></li><li>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></li><li>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></li><li>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></li><li>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/搞定音频技术/01.开篇词">01.开篇词</a><ul><li><a href="/blog/搞定音频技术/01.开篇词/01"><span>开篇词｜实时互动强势发展，如何快速入门音频技术？</span></a></li></ul></li><li><a href="/blog/搞定音频技术/02.音频基础">02.音频基础</a><ul><li><a href="/blog/搞定音频技术/02.音频基础/01"><span>01｜声音是如何保存成数字信号的？</span></a></li><li><a href="/blog/搞定音频技术/02.音频基础/02"><span>02｜如何量化分析语音信号？</span></a></li><li><a href="/blog/搞定音频技术/02.音频基础/03"><span>03｜如何分析与处理音乐信号？</span></a></li><li><a href="/blog/搞定音频技术/02.音频基础/04"><span>04｜如何评价音频质量的好与坏？</span></a></li></ul></li><li><a href="/blog/搞定音频技术/03.音频降噪">03.音频降噪</a><ul><li><a href="/blog/搞定音频技术/03.音频降噪/01"><span>05｜音频降噪如何对症下药？</span></a></li><li><a href="/blog/搞定音频技术/03.音频降噪/02"><span>06｜如何将AI技术运用到降噪中？</span></a></li></ul></li><li><a href="/blog/搞定音频技术/04.回声消除">04.回声消除</a><ul><li><a href="/blog/搞定音频技术/04.回声消除/01"><span>07｜如何通过算法自动快速地消除回声？</span></a></li><li><a href="/blog/搞定音频技术/04.回声消除/02"><span>08｜回声消除算法实践指南</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog/搞定音频技术/05.音频网络传输">05.音频网络传输</a><ul><li><a aria-current="page" class="active" href="/blog/搞定音频技术/05.音频网络传输/01"><span>09｜音频编解码器是如何工作的？</span></a></li><li><a href="/blog/搞定音频技术/05.音频网络传输/02"><span>10｜如何选择一个适合你的编解码器？</span></a></li><li><a href="/blog/搞定音频技术/05.音频网络传输/03"><span>11｜网络差怎么办？音频网络传输与抗弱网策略</span></a></li></ul></li><li><a href="/blog/搞定音频技术/06.空间音频">06.空间音频</a><ul><li><a href="/blog/搞定音频技术/06.空间音频/01"><span>12｜空间音频入门：如何实现“声临其境”？</span></a></li><li><a href="/blog/搞定音频技术/06.空间音频/02"><span>13｜如何利用HRTF实现听音辨位？</span></a></li></ul></li><li><a href="/blog/搞定音频技术/07.音频特效生成与算法">07.音频特效生成与算法</a><ul><li><a href="/blog/搞定音频技术/07.音频特效生成与算法/01"><span>14｜音效三剑客：变调、均衡器、混响</span></a></li><li><a href="/blog/搞定音频技术/07.音频特效生成与算法/02"><span>加餐｜音频技术漫谈之好声音是怎么炼成的？</span></a></li><li><a href="/blog/搞定音频技术/07.音频特效生成与算法/03"><span>15｜AI变声：音频AI技术的集大成者</span></a></li></ul></li><li><a href="/blog/搞定音频技术/08.结束语">08.结束语</a><ul><li><a href="/blog/搞定音频技术/08.结束语/01"><span>结束语｜选择比努力更重要</span></a></li><li><a href="/blog/搞定音频技术/08.结束语/02"><span>期末测试｜来赴一场满分之约吧！</span></a></li></ul></li><li><a href="/blog/搞定音频技术/summary">搞定音频技术</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="编/解码器的发展史" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#编解码器的发展史"><span>编/解码器的发展史</span></a></li><li title="音频数据裁剪和量化" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#音频数据裁剪和量化"><span>音频数据裁剪和量化</span></a></li><li title="语音编/解码器的基本原理" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#语音编解码器的基本原理"><span>语音编/解码器的基本原理</span></a></li><li title="音乐编/解码器的基本原理" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#音乐编解码器的基本原理"><span>音乐编/解码器的基本原理</span></a></li><li title="小结" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#小结"><span>小结</span></a></li><li title="思考题" data-depth="2"><a href="/blog/搞定音频技术/05.音频网络传输/01#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="09音频编解码器是如何工作的"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#09音频编解码器是如何工作的"><span class="icon icon-link"></span></a>09｜音频编解码器是如何工作的？</h1><p>你好，我是建元。今天我们来聊聊什么是音频编/解码器，以及它背后的原理。</p><p>在我们讲音频编/解码器之前，你不妨先设想一下：如果没有音频编/解码器，我们直接给对方发送原始数据，会发生什么事情呢？</p><p>我们假设一个在线会议有10个人，每个人要发给另外9个人的音频信号是48kHz采样率的单通道音频。每个采样点我们用16位的浮点来表示。那么上行通道中我们需要每秒发送48000乘以16 bit的音频信号，也就是大约768kbps；而接收的下行通路的信号是除了你之外的另外9个人的信号，也就是6912kbps。</p><p>所以上行加下行要想在没有音频编/解码的情况下，完成一个10人的在线会议，你需要消耗7.5Mb的带宽在音频信号上，来保证流畅的音频通话，注意这里我们还没有计算发送的包头以及抗弱网所需要的额外带宽。</p><p>这么大的带宽消耗在带来巨大成本的同时，也会在网络条件比较差或者通话人数比较多的时候让实时音频出现卡顿甚至不可用的问题。所以音频编/解码器的任务就是在减少带宽码率消耗的同时，尽量保持音频的音质不会受到损伤。</p><p>那么具体是如何实现的呢？这节课我们就来说道说道。清楚了这些，对于你接下来实践音频编解码，以及选择合适的编解码器都是大有帮助的。</p><h2 id="编解码器的发展史"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#编解码器的发展史"><span class="icon icon-link"></span></a>编/解码器的发展史</h2><p>这里我们从发展的视角看下，音频编/解码器都有哪些类型，就以它的作用来区分吧。</p><p>音频编/解码器包括编码和解码两个部分。编码的过程就是对音频进行压缩，而<strong>压缩的过程是为了保留音频的主要甚至全部信息</strong>。解码就是对压缩后的音频信号进行解码，从而恢复原始的音频信号。</p><p>压缩按照是否可以完美还原，可以分为无损压缩和有损压缩。无损压缩，例如APE、FLAC等格式可以让音频中所有的细节都得到还原，而有损压缩可提供更低的码率，是我们在实时音频中使用更多的压缩类型。</p><p>一段音频包含的信息其实可以有很多。比如，里面可能有语音、乐器、噪声等多种信号，而其中的语音部分，是我们平时实时音频互动中最重要的部分。</p><p>最早的一批实时音频编/解码器，如**基于ITU标准的G.71等就是针对如何保持语音部分而设计的****。**<strong>我们把这一类音频编/解码器叫做语音编/解码器</strong>。</p><p>后来为了传输更多的信息，比如包括音乐甚至“噪声”等全部音频信号的编/解码器，例如基于MPEG标准的MP3和AAC也陆续出现。</p><p>随后，**主要用来编码语音信号的语音编/解码器，逐渐向基于时域的线性预测框架的方向演化。**这种编/解码器参考了声道的发音特性，将语音信号分解为主要的线性预测系数和次要的残差信号。而线性预测系数编码所需的比特率非常少，却能高效地构建出语音信号的“骨骼”；残差信号则像是“血肉”，能够补充出语音信号的细节。这种设计大幅提升了语音信号的压缩效率。<strong>但是这种基于时域的线性预测框架在有限的复杂度下无法很好地编码音乐信号。</strong></p><p>因此，<strong>针对音乐信号进行编码的音乐编/解码器走上了另一条演化的道路</strong>。因为相比时域信号，频域信号的信息更多集中在少部分频点上，更利于编码器对其进行分析和压缩。所以<strong>音乐编/解码器基本都会选择在频域上对信号进行频域编码</strong>。比如图1中基本上语音的频谱从下到上是连续的（频谱上呈现为一团红色或者一些横跨不同频率的曲线），音乐信号则在部分频段上有一些持续性的能量（频谱上呈现为一条一条的直线）。</p><p><img src="https://static001.geekbang.org/resource/image/8d/ac/8d2c2ec5c5c9a99507f50bc374212dac.png?wh=864x493" alt="图片" title="图1 人声（左）和音乐（右）波形和频谱图"/></p><p>后来，随着技术日趋成熟，**两种编/解码架构又再次走到了一起，即语音音乐混合编码器。**WebRTC中默认使用的编/解码器OPUS就是这类编/解码器。<strong>这类编/解码器的特点是融合了两种编码框架，并针对信号类型自动切换合适的编码框架</strong>。一些国内外知名的产品都会用到OPUS，比如Discord。</p><p>会议等主要以人声为主的场景可以使用语音编解码器省流量，而音乐直播等场景则需要更多的流量来保证音质，或者两者都有的情况下可以选用OPUS这样的来自动调节，具体如何选择编/解码器会在下一讲中详细介绍。这里会先介绍一些通用的方法比如音频数据裁剪和量化，再举例介绍一下语音和音乐编解码器的基本原理。</p><p>编/解码的算法细节比较多，这里我们主要介绍一些常见的方法，看看我们是如何一步步的把音频的码率降下来，而又不损伤音质的。</p><h2 id="音频数据裁剪和量化"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#音频数据裁剪和量化"><span class="icon icon-link"></span></a>音频数据裁剪和量化</h2><p>还记得我们一开始举的那个例子么，即48kHz、每个采样点用16bit的浮点来表示的音频。实际上，音频压缩的第一步就是从这些音频的参数出发来缩减采样率和采样精度非线性量化。不懂？没关系，继续往下看。</p><p>先了解点基础知识，根据编码音频的带宽，我们可以把音频分为窄带、宽带、超宽带和全通带。下表中我列出了带宽和采样频率的关系。</p><p><img src="https://static001.geekbang.org/resource/image/be/68/bed907472950a2d7619982ee188c5768.jpg?wh=1280x294" alt=""/></p><p>举个例子帮助你理解，你可以关注一下打电话这个场景，打电话的时候我们能听得见对方在说什么，但是往往会觉得声音有点闷。这是因为打电话时语音信号的采样率实际上只有8kHz，也就是窄带信号，根据采样定律这里的有效频谱是0～4kHz。所以说，在低采样率的情况下，语音信号中的语音信息被有效保留了，而更高频的音色信息没有被保留。总结来说，就是采样率降低了，每秒发出的数据量也就降低了，这就是通过缩减采样率来压缩了音频。</p><p>那么采样精度非线性量化又是什么意思呢？还是回到最开始的例子，我们每个采样点用16bit的浮点来表示，而如果换做非线性量化来表示可能只需要8bit就可以，从听感上来说却不会有太大的损失。这是为什么呢？</p><p>比如，**G.711中的A-LAW就是采用非线性量化的方式对每个采样点进行压缩。**而在这里用8bit量化的采样点表示就可以比16bit的少一半的数据量。在图1的语音时域信号里我们可以发现，大部分信号的幅度都在比较低的范围内，只有少部分的幅度值会比较大。如果我们给予更多的精度用于描述低幅度的信号，那么压缩后，听感上的损失就会比较小。比如下面A-LAW公式中就是通过固定值$1/A$作为区分幅度大小的的界限，用非线性的对数ln来划分表达的幅度位置，对高、低幅度分别用不同的量化精度对采样点进行量化。</p><p>$$f(x)=\begin<!-- -->{<!-- -->cases<!-- -->}<!-- -->A(x)/(1+lnA), &amp; <!-- -->{<!-- -->0&lt;=x&lt;=1/A<!-- -->}<!-- --> \\(1+lnAx)/(1+lnA), &amp; <!-- -->{<!-- -->1/A&lt;=x&lt;=1<!-- -->}<!-- -->\end<!-- -->{<!-- -->cases<!-- -->}<!-- -->\text<!-- -->{<!-- --> A-LAW解码<!-- -->}<!-- -->$$</p><h2 id="语音编解码器的基本原理"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#语音编解码器的基本原理"><span class="icon icon-link"></span></a>语音编/解码器的基本原理</h2><p>上述缩减采样率和采样精度非线性量化都是数据层面的压缩，接下来我们再看看如何从语音合成建模的角度对语音进行编/解码。这里我们常采用线性预测编码（LPC）。</p><p>这里你可以先回想一下我们之前讲的人发声的基本原理。人类发声时，声带振动得到的是浊音，而声带不震动并且通过气流吹过唇齿等部位产生的声音为清音。音调或者说音高就表现为基频F0的频率高低，其中这个基频是声带振动的频率。而音色则是由频谱的包络来决定的。频谱包络反映的是咽喉、嘴、鼻等声道的形状引发的共振信息，所以频谱包络也就是音效中常说的共振峰曲线。</p><p>再联想一下前面我们讲语音信号分析时，我们发啊、哦、额的时候，我们的口型是不是不一样的。因此，在语音的建模中，模拟声道建模的线性预测滤波器就可以派上用处了。线性滤波器的系数（LPC）反映的是各个声道器官的状态。而在10～30ms时间内器官移动的距离有限，所以我们可以认为声道器官的位置基本不变化，这样就可以利用线性滤波器来对语音进行编码。而线性滤波器的系数远比时域对应帧的采样点个数要少很多，比如我们一般用16阶的LPC就可以来表示一个10ms、16kHz采样的160点的帧。LPC的公式如下所示，我们可以看到这是一个自回归的模型，即当前值是过去值的加权预测。</p><p>$$y(n)=a_1y(n-1)+a_2y(n-2)+a_3y(n-3)+…+e(n)\text<!-- -->{<!-- --> LPC模型<!-- -->}<!-- -->$$</p><p>基于LPC的编/解码器的结构如图2所示：</p><p><img src="https://static001.geekbang.org/resource/image/50/8c/5099457df5213b9246869a2d253ff68c.jpg?wh=1280x396" alt="" title="图2 基于LPC的编/解码器"/></p><p>其中，基音检测是LPC类型的编/解码器必备的模块之一。**基音检测模块会提供两个信息：一个是信号的周期性，也就是区分是清音还是浊音；另一个是如果是浊音那么基频是多少Hz。**如果判断为浊音，那么激励信号产生器会产生一个和基频相同周期的脉冲激励信号；如果是清音则产生一个白噪声，然后由线性预测合成器按照频谱包络来还原出原始音频。</p><p>LPC模型是线性预测，有预测就会有预测误差。值得注意的是在LPC模型的公式里我们可以看到还有一项$e(n)$，我们把这一项叫做噪声或者残差（excitation）。由于音频信号不可能是完全线性的，如果这个部分缺失，你依然可以听清楚一个语音发的是什么音，但声音会非常“生硬”，或者说听着像机器人。因此，我们实际使用LPC模型时还需要对残差部分来进行编码传输。也就是说在编码传输的时候我们需要传递LPC系数和残差这两个部分，才能在解码时将语音比较好的还原出来。</p><p>例如，在实际使用中，由Skype公司发明的基于LPC的SILK编/解码器使用长时预测分析（LPT）来估计残差信号，使用Burgs方法来计算LPC系数。LPC系数被转换为线谱频率（LSF）向量，然后对LSF进行矢量量化（VQ，Vector Quantization），在解码的时候再结合残差信号把LSF转换为LPC系数。这样就实现了残差和LPC系数的编码。如果直接用LPC系数做量化，一两个系数的误差可能会导致某些频段有较大的失真。在这里，LSF是对LPC模型的因式分解形式，在后续做量化的时候可以减少单一频段的失真。</p><p>对于类似LPC的参数编码器，可以注意到如果类似LPC的参数不进行进一步编码，每一帧仍需要传一组LPC参数或LSF参数。如果1秒有100帧，那么这个码率还是有点大的。例如SILK中就使用了多级向量码本的方式来解决这个问题。 我们通常把这个过程叫矢量量化VQ。</p><p>**VQ是一种基于块编码规则的有损数据压缩方法。**事实上，在音视频中的JPEG和MPEG-4等多媒体压缩格式里都有VQ这一步。它的基本思想是：将若干个标量数据组构成一个矢量，然后在矢量空间给以整体量化，从而压缩了数据。</p><p>比如**编码器中每一帧都有一组需要编码的参数向量，那这些参数就可以通过有限数量的固定向量来表达。**比如固定1024种参数的组合，这时如果有新的需要量化的参数向量则需要找到和它最接近的那个固定向量来表达。这个固定的1024个参数向量我们把它编成一个码本，且码本的标号1至1024分别代表这1024种参数组合。那么在编码的时候只需要从码本中找到与这个最接近的参数向量的编号，比如16，然后把16发给解码器。解码端有一个同样的码本。解码的时候只需要去找第16个编号代表的参数向量就可以实现解码。这样传输过程中只用到16这一个数，而参数向量一共有1024种可能，所以编码的时候使用11bit来编码就可以了。</p><p>**VQ所需的码本是通过大量的离线语料训练得到的。**VQ的训练方法有很多，常见的有LBG-VQ，K-means等，这里我们不再详细介绍。<strong>其中SILK所用的是多级码本</strong>。这里的多级码本是指第一阶段的输入是待量化的矢量，而之后每一级的输入是前一级的输出的量化误差。比如一个三级码本，编码的时候需要传3个编号，解码的时候则分别根据编号查三个码本，然后把三个码本的向量相加，从而得到完整的解码结果。</p><h2 id="音乐编解码器的基本原理"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#音乐编解码器的基本原理"><span class="icon icon-link"></span></a>音乐编/解码器的基本原理</h2><p>上面这些主要是语音编码器的基本原理。我们可以看到<strong>语音编码器主要是对语音的发声来建模编/解码</strong>。而音乐编/解码器因为要编码频带更丰富的音乐信号，所以更多的是<strong>从听得清晰的角度利用心理听觉来进行编码</strong>。也就是说我们人耳更敏感的频带需要多耗费一些码率来编码，不敏感的则少耗费一些码率。</p><p>这里我们以CELT编/解码器作为例子。CELT编码全称是Constrained Energy Lapped Transform，主要使用MDCT编码。离散余弦变换（<a target="_blank" rel="noopener noreferrer" href="https://www.egr.msu.edu/waves/people/Ali_files/DCT_TR802.pdf">DCT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）在音、视频编码中都是常用的降维方法，对其内部原理有兴趣的同学可以自行了解一下。MDCT其实就是时域重叠的DCT变换，主要是为了消除DCT带来的块效应。MDCT的正、逆变换可以参照图3。</p><p><img src="https://static001.geekbang.org/resource/image/3a/82/3a980a6fb2cc5c51301ae3dae52db282.jpg?wh=1280x720" alt="" title="图3 MDCT和IMDCT"/><br/>MDCT编码主要过程是分帧，然后一次有重叠的取几帧（比如图3是一次取2帧）做MDCT变换得到一个编码信息。解码时，每个编码信息通过IMDCT逆变换还原编码的那几帧的信号，然后再通过滑动叠加的方式得到还原的音频信号。</p><p>之前的课程里我们讲过人对不同的频带的感知是不同的，比如，人对低频较高频的频率变化较为敏感。回想一下我们之前讲过的人耳敏感频响曲线，Bark谱和Mel谱。在音乐这种频带分布比较随机的信号，就需要对不同的频段加以划分，有的频段人的听感比较敏感就需要更细致的编码，相反则可以进行加大程度的压缩。</p><p>比如CELT中的MDCT变换频谱就是基于Bark频带的，并且选了约21个频带进行编码。每个频带都进行分析、量化数据，并通过预测压缩，可以直接将差异传到预测值。Bark谱的频带分布可以参照图4。</p><p><img src="https://static001.geekbang.org/resource/image/bf/d3/bf4a300980645d79349d4yy91a5ba3d3.png?wh=864x114" alt="图片" title="图4 CELT中Bark谱的频带分布"/></p><p>从DCT系数中去除未量化频段的能量值，产生的剩余信号的系数部分是通过金字塔矢量量化（PVQ）来编码的。这种编码方式使用固定（可预测）长度的码字，从而对比特位错误有更好的鲁棒性。CELT将频带的能量分为粗粒度能量和细粒度能量，并且两者相加为整体的频带能量。而在编码时可根据想要编的码率来调节粗细力度的码率分配，这样就可以兼容不同的码率设置。具体CELT的编码流程如图5所示：</p><p><img src="https://static001.geekbang.org/resource/image/8f/f9/8f12503780e52a76bf087b1d44d6b2f9.jpg?wh=1280x390" alt="" title="图5 CELT的编码流程"/></p><h2 id="小结"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#小结"><span class="icon icon-link"></span></a>小结</h2><p>这一讲我们主要介绍了一些音频编/解码的基本原理。音频的编/解码主要有语音编/解码、音乐编/解码和混合编/解码。其中通用的编/解码方法有非线性量化、减少采样率、矢量量化等方法。对于语音信号可以使用声道模型建模，然后采用线性预测加残差的方法来进行编/解码，而对音乐信号则需要根据人耳敏感频响曲线分频带来建模。</p><p>其中，在WebRTC 中默认使用的编/解码器 OPUS 就是这类编/解码器。其语音主要采用SILK来编码，音乐则采用CELT来编码。在OPUS内部还有一个基于人工神经网络的音乐判断器来进行人声和音乐的自动切换，从而达到最好的编/解码效果。</p><p>其实在音频编/解码领域有很多成熟而优秀的编/解码器，初学者不要被这些复杂的数学、声学、心理学知识所吓到。我们完全可以在掌握编/解码器原理的基本概念之后根据自己的场景，选择一些成熟的编/解码器来使用，具体怎么选我们将会在下一讲中详细介绍。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog/搞定音频技术/05.音频网络传输/01#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>如果我们人类每分钟最多说200个字，假设一共有4096个常用汉字。设想一下如果采用文字识别作为编码（语音转文字ASR），然后用文字转语音技术（TTS）来解码那这种编/解码器的码率会是多少？提示一下，4096可以用多少bit来表达？</p><p>欢迎留言和我分享你的答案和疑惑。我们下节课再见！</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/docs/搞定音频技术/05.音频网络传输/01.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">5/2/2022 10:57:07</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog/umi.js"></script>
  </body>
</html>
