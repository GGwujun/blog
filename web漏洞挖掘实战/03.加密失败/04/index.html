<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog/umi.css" />
    <script>
      window.routerBase = "/blog";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>09｜密码算法问题：数学知识如何提高代码可靠性？</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/web漏洞挖掘实战/03.加密失败/04" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></span><span>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></span><span>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></span><span>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></span><span>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></span><span>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></span><span>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></span><span>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></li><li>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></li><li>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></li><li>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></li><li>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></li><li>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></li><li>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></li><li>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/web漏洞挖掘实战/01.课前必读">01.课前必读</a><ul><li><a href="/blog/web漏洞挖掘实战/01.课前必读/01"><span>开篇词｜从黑客的视角找漏洞，从安全的角度优雅coding</span></a></li><li><a href="/blog/web漏洞挖掘实战/01.课前必读/02"><span>导读｜解读OWASP Top10 2021</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制">02.失效的访问控制</a><ul><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/01"><span>01｜失效的访问控制：攻击者如何获取其他用户信息？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/02"><span>02｜路径穿越：你的Web应用系统成了攻击者的资源管理器？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/03"><span>03 | 敏感数据泄露：攻击者如何获取用户账户？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/04"><span>04｜权限不合理：攻击者进来就是root权限？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/05"><span>05｜CSRF：为什么用户的操作他自己不承认？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战/03.加密失败">03.加密失败</a><ul><li><a href="/blog/web漏洞挖掘实战/03.加密失败/01"><span>06｜加密失败：使用了加密算法也会被破解吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/02"><span>07｜弱编码：程序之间的沟通语言安全吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/03"><span>08｜数字证书：攻击者可以伪造证书吗？</span></a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战/03.加密失败/04"><span>09｜密码算法问题：数学知识如何提高代码可靠性？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/05"><span>10｜弱随机数生成器：攻击者如何预测随机数？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/06"><span>11｜忘记加“盐”：加密结果强度不够吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/07"><span>大咖助场｜数字证书，困境与未来</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/04.注入">04.注入</a><ul><li><a href="/blog/web漏洞挖掘实战/04.注入/01"><span>12｜注入（上）：SQL注入起手式</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/02"><span>13｜注入（下）：SQL注入技战法及相关安全实践</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/03"><span>14｜自动化注入神器（一）：sqlmap的设计思路解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/04"><span>15｜自动化注入神器（二）：sqlmap的设计架构解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/05"><span>16｜自动化注入神器（三）：sqlmap的核心实现拆解</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/06"><span>17｜自动化注入神器（四）：sqlmap的核心功能解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/07"><span>18 | 命令注入：开发的Web应用为什么成为了攻击者的bash？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/08"><span>19 | 失效的输入检测（上）：攻击者有哪些绕过方案？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/09"><span>20 | 失效的输入检测（下）：攻击者有哪些绕过方案？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/10"><span>21｜XSS（上）：前端攻防的主战场</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/11"><span>22｜XSS（中）：跨站脚本攻击的危害性</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/12"><span>23｜XSS（下）：检测与防御方案解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/13"><span>24｜资源注入：攻击方式为什么会升级？</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划">05.春节特别策划</a><ul><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/01"><span>春节策划（一）｜ 视频课内容精选：Web渗透测试工具教学</span></a></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/02"><span>春节策划（二） ｜ 给你推荐4本Web安全图书</span></a></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/03"><span>春节策划（三） | 一套测试题，看看对课程内容的掌握情况</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计">06.不安全的设计</a><ul><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/01"><span>25｜业务逻辑漏洞：好的开始是成功的一半</span></a></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/02"><span>26｜包含敏感信息的报错：将安全开发标准应用到项目中</span></a></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/03"><span>27｜用户账户安全：账户安全体系设计方案与实践</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误">07.安全配置错误</a><ul><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/01"><span>28｜安全配置错误：安全问题不只是代码安全</span></a></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/02"><span>29｜Session与Cookie：账户体系的安全设计原理</span></a></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/03"><span>30｜HTTP Header安全标志：协议级别的安全支持</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲">08.其他安全风险串讲</a><ul><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/01"><span>31｜易受攻击和过时的组件：DevSecOps与依赖项安全检查</span></a></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/02"><span>32｜软件和数据完整性故障：SolarWinds事件的幕后⿊⼿</span></a></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/03"><span>33｜SSRF：穿越边界防护的利刃</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇">09.综合实战篇</a><ul><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/01"><span>34｜Crawler VS Fuzzing：DAST与机器学习</span></a></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/02"><span>35｜自动化攻防：低代码驱动的渗透工具积累</span></a></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/03"><span>36｜智能攻防：构建个性化攻防平台</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/10.结束语">10.结束语</a><ul><li><a href="/blog/web漏洞挖掘实战/10.结束语/01"><span>结束语｜无畏前行</span></a></li><li><a href="/blog/web漏洞挖掘实战/10.结束语/02"><span>期末测试｜来赴一场满分之约吧！</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/summary">web漏洞挖掘实战</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="数学层面的密码安全风险" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#数学层面的密码安全风险"><span>数学层面的密码安全风险</span></a></li><li title="古典密码学" data-depth="3"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#古典密码学"><span>古典密码学</span></a></li><li title="现代密码学" data-depth="3"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#现代密码学"><span>现代密码学</span></a></li><li title="密码算法安全性" data-depth="3"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#密码算法安全性"><span>密码算法安全性</span></a></li><li title="工程实践中的密码安全风险" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#工程实践中的密码安全风险"><span>工程实践中的密码安全风险</span></a></li><li title="案例实战" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#案例实战"><span>案例实战</span></a></li><li title="数字签名伪造" data-depth="3"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#数字签名伪造"><span>数字签名伪造</span></a></li><li title="HASH碰撞与生日攻击" data-depth="3"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#hash碰撞与生日攻击"><span>HASH碰撞与生日攻击</span></a></li><li title="总结" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#总结"><span>总结</span></a></li><li title="思考题" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/04#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="09密码算法问题数学知识如何提高代码可靠性"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#09密码算法问题数学知识如何提高代码可靠性"><span class="icon icon-link"></span></a>09｜密码算法问题：数学知识如何提高代码可靠性？</h1><p>你好我是王昊天，今天这一讲我们来一起学习密码算法问题。</p><p>温州话素以难懂著名，据传连温州附近的其他城市也很难理解。这种客观条件，为使用温州话传递秘密信息创造了土壤，因此有一种说法是，抗日战争时期中国军队使用温州话进行秘密通信。</p><p>这听起来确实还挺有可行性的，而且二战时期美军就曾使用纳瓦霍语做出类似的操作。</p><p>使用一种复杂形式的通用性语言作为“加密”方案，虽然在某种现实应用中可以奏效，但在算法选择上其实并不明智。</p><p>要知道，语言是可以翻译的。因此，如果将信息传递的安全性完全依赖于语言复杂性特质，一旦这种语言具有较大受众，对方就很可能具备该类语言的解析能力，从而使该语言失去保密效果。</p><p>在密码学中，这种使用难懂语言的加密方案可以归类到的古典密码算法，而现代社会普遍采用了现代密码学，加密信息的安全性已经不再依赖密码算法的保密性。</p><p>这一讲，我们就来一起研究密码算法的安全性。</p><h2 id="数学层面的密码安全风险"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#数学层面的密码安全风险"><span class="icon icon-link"></span></a>数学层面的密码安全风险</h2><h3 id="古典密码学"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#古典密码学"><span class="icon icon-link"></span></a>古典密码学</h3><p>古典密码学是密码学中的一个类型，主要使用<strong>替换式密码</strong>或<strong>移项式密码</strong>。尽管古典密码学由于安全性不足等问题现在已经逐渐退出实际应用了，但是我们从它开始了解密码学的发展历程，可以帮助你理解更深层的密码学原理。那么接下来，我们就来看几种经典的古典密码算法。</p><p><strong>凯撒密码</strong>是一种广为人知的加密技术，是一种替换式密码。它的加密逻辑是非常简单的，明文中的字母按照固定偏移向后取值，结果即为密文，反之即是解密过程。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></div><div class="token-line"><span class="token plain">    密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC</span></div></pre></div><p>凯撒加密也可以使用更直观的数学公式来表示：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Res_Enc = ( plain_text + n ) mod 26</span></div><div class="token-line"><span class="token plain">    Res_Dec = ( cipher_text - n ) mod 26</span></div><div class="token-line"><span class="token plain">    其中n代表偏移量</span></div></pre></div><p>可以看到，如此简单的加解密逻辑，在目前的技术发展下安全性是非常低的，站在当下，凯撒密码的影响如何我们已无从知晓，但是从凯撒密码的知名度和影响力来看，它确实是在当时被广泛使用的。根据现有的记载，直到公元9世纪，人们都没有任何技术能够破解这种最基本、最简单的替换密码，要知道凯撒可是生活在公元前1世纪。</p><p>在了解凯撒密码的原理之后，如果让你来强化加密算法，你会选择什么方案呢？</p><p>也许聪明的你已经想到了，最直观的方案就是，让字母的替代逻辑更加复杂。凯撒密码是一种经典的单字母替代式密码，那么它的进阶形态就变成了多字母替代式密码，在历史上它还有一个经典的名称——<strong>维吉尼亚密码。</strong></p><p>维吉尼亚密码的运算逻辑会稍显复杂，首先会生成一个二维矩阵Matrix，然后再选择一个关键字X：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Matrix:</span></div><div class="token-line"><span class="token plain">                    A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</span></div><div class="token-line"><span class="token plain">                    B C D E F G H I J K L M N O P Q R S T U V W X Y Z A</span></div><div class="token-line"><span class="token plain">                    C D E F G H I J K L M N O P Q R S T U V W X Y Z A B</span></div><div class="token-line"><span class="token plain">                    D E F G H I J K L M N O P Q R S T U V W X Y Z A B C</span></div><div class="token-line"><span class="token plain">                    E F G H I J K L M N O P Q R S T U V W X Y Z A B C D</span></div><div class="token-line"><span class="token plain">                    F G H I J K L M N O P Q R S T U V W X Y Z A B C D E</span></div><div class="token-line"><span class="token plain">                    G H I J K L M N O P Q R S T U V W X Y Z A B C D E F</span></div><div class="token-line"><span class="token plain">                    H I J K L M N O P Q R S T U V W X Y Z A B C D E F G</span></div><div class="token-line"><span class="token plain">                    I J K L M N O P Q R S T U V W X Y Z A B C D E F G H</span></div><div class="token-line"><span class="token plain">                    J K L M N O P Q R S T U V W X Y Z A B C D E F G H I</span></div><div class="token-line"><span class="token plain">                    K L M N O P Q R S T U V W X Y Z A B C D E F G H I J</span></div><div class="token-line"><span class="token plain">                    L M N O P Q R S T U V W X Y Z A B C D E F G H I J K</span></div><div class="token-line"><span class="token plain">                    M N O P Q R S T U V W X Y Z A B C D E F G H I J K L</span></div><div class="token-line"><span class="token plain">                    N O P Q R S T U V W X Y Z A B C D E F G H I J K L M</span></div><div class="token-line"><span class="token plain">                    O P Q R S T U V W X Y Z A B C D E F G H I J K L M N</span></div><div class="token-line"><span class="token plain">                    P Q R S T U V W X Y Z A B C D E F G H I J K L M N O</span></div><div class="token-line"><span class="token plain">                    Q R S T U V W X Y Z A B C D E F G H I J K L M N O P</span></div><div class="token-line"><span class="token plain">                    R S T U V W X Y Z A B C D E F G H I J K L M N O P Q</span></div><div class="token-line"><span class="token plain">                    S T U V W X Y Z A B C D E F G H I J K L M N O P Q R</span></div><div class="token-line"><span class="token plain">                    T U V W X Y Z A B C D E F G H I J K L M N O P Q R S</span></div><div class="token-line"><span class="token plain">                    U V W X Y Z A B C D E F G H I J K L M N O P Q R S T</span></div><div class="token-line"><span class="token plain">                    V W X Y Z A B C D E F G H I J K L M N O P Q R S T U</span></div><div class="token-line"><span class="token plain">                    W X Y Z A B C D E F G H I J K L M N O P Q R S T U V</span></div><div class="token-line"><span class="token plain">                    X Y Z A B C D E F G H I J K L M N O P Q R S T U V W</span></div><div class="token-line"><span class="token plain">                    Y Z A B C D E F G H I J K L M N O P Q R S T U V W X</span></div><div class="token-line"><span class="token plain">                    Z A B C D E F G H I J K L M N O P Q R S T U V W X Y</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    X:</span></div><div class="token-line"><span class="token plain">                    WORD</span></div></pre></div><p>接下来根据明文长度，延展X使其和明文一样长，取得Y：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">X: WORD</span></div><div class="token-line"><span class="token plain">    plain_text: I LOVE CRYPTOGRAPHY</span></div><div class="token-line"><span class="token plain">    Y: W ORDW ORDWORDWORDW</span></div></pre></div><p>根据每一位的明文以及Y的取值，分别匹配到Matrix的坐标，即可得出密文，以第一位加密为例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Matrix(W,I) = E</span></div></pre></div><p>逐位运算即可取得加密结果：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cipher_text: E ZFYA QIBLHFJNOGKU</span></div></pre></div><p>学习了替换式密码之后，我们再来看一下移位式密码。移位式密码，字母本身是不变的，但是传递过程中的顺序会按照特定的定义进行改变。举个最简单的例子：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">plain_text: Hello World!</span></div><div class="token-line"><span class="token plain">    cipher_text: olleH !dlroW</span></div></pre></div><p>可以看到，移位式密码的逻辑是比较简单的，更复杂的移位式密码也是在变换上更加复杂，但是底层逻辑是不变的。</p><h3 id="现代密码学"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#现代密码学"><span class="icon icon-link"></span></a>现代密码学</h3><p>现代密码学主要可以分为两个领域，<strong>对称密钥密码学</strong>和<strong>非对称密钥密码学</strong>，这两者之间最核心区别就是，加密和解密的密钥是否相同。</p><p>对于对称密钥密码学，还可以进一步分为<strong>分组密码</strong>与<strong>流密码</strong>两个算法种类。其中，分组密码的输入使用明文的一个区块和密钥，然后输出相同大小的密文区块；流密码相对于分组密码则更为灵活，输入中的明文可以任意长，经过与密钥轮的数学操作后，输出与明文等长的加密流。</p><p>非对称密钥密码学还有一个名字，公钥密码学。其特征就是具备公钥和私钥两个不同密钥，并且均可以参与加密与解密过程。使用公钥加密、私钥解密是典型的隐秘信息保护流程；而使用私钥加密、公钥解密则是典型的签名流程。可以说，除加密外，公钥密码学最大的贡献就是实现了数字签名，互联网上的PKI体系以及SSL/TLS等网络安全机制均以此为基础构建。</p><p>关于底层原理，公钥密码算法的难度大多体现在计算复杂度上，比如RSA源于大整数因数分解问题、DSA源于离散对数问题、椭圆曲线密码学则源于椭圆曲线相关数学难题。由于这些底层问题多涉及模数乘法或指数运算，因此计算复杂度相较于对称密钥算法会更高。</p><p>为了在实际应用中达到更高的效率，普遍采用的方案是外部使用公钥密码算法，内部使用对称密钥算法，这样既可以获得公钥密码算法的优秀特性，可以获得对称密码算法的高执行效率，业内一种实践方案是信封加密。</p><p>目前，现代密码学在一些领域已经有非常前沿的实际应用场景，如交互证明、零知识、区块链与安全多方计算等。</p><h3 id="密码算法安全性"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#密码算法安全性"><span class="icon icon-link"></span></a>密码算法安全性</h3><p>经典密码通常很容易破解，普遍通过唯密文攻击法，在仅知密文的情况下就可以完成攻击。以凯撒密码为例，有限的密钥个数可以通过暴力破解完成攻击；替代式密码虽然有着更大的密钥数，但是会被频率分析破解；更进一步地，维吉尼亚密码使用多个替换防止简单的频率分析，但是依然可以使用更为先进的卡西斯基试验进行破解。</p><p>和经典密码学相比，现代密码学的安全性已经不依赖于加密算法的保密性，而是基于密钥的安全性，也就是说即使在密码算法完全公开的情况下，只要攻击者无法获取密钥就无法破解密文。</p><p>关于密文的破解有多种分类，其中最为普遍的划分方法是，<strong>按照攻击者获取的信息多少</strong>进行划分。在唯密文攻击中，攻击者的已知信息只有密文；在已知明文攻击中，攻击者的已知信息包括多个明文、密文对；在选择明文攻击中，攻击者可以自选任意明文，并获得相应的密文；在选择密文攻击中，攻击者可以选择任意密文，并获得相应明文。</p><p>另外一种破解分类，是<strong>按照信息来源</strong>进行分类的，像我们提到的4种攻击方式以及密码算法层的分析都被归类为主信道攻击；与之相对的是侧信道攻击，这种攻击方式重点关注加密设备在执行过程暴露的信息，比如通过分析加解密时间、错误码等来进行破解。</p><h2 id="工程实践中的密码安全风险"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#工程实践中的密码安全风险"><span class="icon icon-link"></span></a>工程实践中的密码安全风险</h2><p>除了数学理论层面的安全性风险之外，在工程实践中我们也会遇到许多密码学相关的安全风险，接下来就带你了解有哪些典型的风险场景。</p><p><strong>硬编码密钥</strong></p><p>在一些应用系统中，开发者可能会为了方便将加密密钥硬编码在源码中，在这种情况下，一旦应用系统被入侵，攻击者将可以轻松获得密钥，从而为后续入侵、提权、持久化埋下伏笔。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">int verifyAdmin( char *password)</span></div><div class="token-line"><span class="token plain">    {</span></div><div class="token-line"><span class="token plain">        if( strcmp(password, &quot;68af404b513073584c4b6f22b6c63e6b&quot;) )</span></div><div class="token-line"><span class="token plain">        {</span></div><div class="token-line"><span class="token plain">            printf(&quot;Incorrect Password!\n&quot;);</span></div><div class="token-line"><span class="token plain">            return(0);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        return(1);</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p><strong>随机值重用</strong></p><p>很多密码算法在应用过程中，会涉及到随机值的使用。在一些开发场景中，开发者将随机值固定为某一数值，使得随机值发生重用，这样可能会导致身份伪装等中间人攻击行为的发生。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">void encryptAndSendPassword( char *password)</span></div><div class="token-line"><span class="token plain">    {</span></div><div class="token-line"><span class="token plain">        char *tmp = &quot;bad&quot;;</span></div><div class="token-line"><span class="token plain">        ...</span></div><div class="token-line"><span class="token plain">        char *data = (unsigned char*)malloc(20);</span></div><div class="token-line"><span class="token plain">        int para_size = strlen(tmp) + strlen(password);</span></div><div class="token-line"><span class="token plain">        char *paragraph = (char*)malloc(para_size);</span></div><div class="token-line"><span class="token plain">        SHA1((const unsigned char*)paragraph, para_size, (unsigned char*)data);</span></div><div class="token-line"><span class="token plain">        ...</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p><strong>不安全的加密算法</strong></p><p>在开发过程中使用不安全的加密算法，可能会导致敏感信息的泄露，同时这会给攻击者更多攻击的机会，因为如果一个加密算法存在安全缺陷，那么对它的攻击方式很可能已经广为人知了。</p><p>也许你会好奇，是谁设计了不安全的加密算法呢？加密算法从诞生到应用，一定是经过了广泛实践检验的。但是由于近些年科技高速发展，无论是从理论算法层面发现了加密算法的缺陷，还是从算力增长的角度发现了某种现实性攻击，都使得加密算法的更新速度大幅提高，那些曾经被验证是安全的加密算法现如今也就变得不再安全了。</p><p>如下代码示例使用了DES加密算法，考虑到目前DES已经被认为是不安全的，因此这段代码的安全性存在缺陷，在实际应用中目前普遍采用AES作为替代方案。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">function encryptPassword( $password )</span></div><div class="token-line"><span class="token plain">    {</span></div><div class="token-line"><span class="token plain">        $iv_size = mcrypt_get_iv_size(MCRYPT_DS, MCRYPT_MODE_ECB);</span></div><div class="token-line"><span class="token plain">        $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);</span></div><div class="token-line"><span class="token plain">        $key = &quot;This is a password encryption key&quot;;</span></div><div class="token-line"><span class="token plain">        $encrypted_password = mcrypt_encrypt(MCRYPT_DES, $key, $password, MCRYPT_MODE_ECB, $iv);</span></div><div class="token-line"><span class="token plain">        ...</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p><strong>可预测的初始化向量（Initialization Vector, IV）</strong><br/>许多加密算法会使用初始化向量来强化安全性，以DES加密算法为例，其加密模式分为多种，其中CBC模式就与初始化向量相关。在设置初始化向量的过程中，如果初始化向量可以被预测，那么算法的安全性就会降低。</p><p>这里我们仍然以DES算法的CBC模式为例，来分析初始化向量对于加密算法安全性的影响。</p><p>在了解CBC模式前，你需要先了解ECB模式，这是最简单的块密码加密模式，全称是电子密码本（Eclectronic codebook）模式，ECB模式在加密前根据块的大小将明文分为若干块，之后每块使用相同的密钥单独加密，解密同理。</p><p>ECB模式的优势很明显，首先加密逻辑非常简单，其次由于上下文无关，所以有利于并行计算，最后仍然得益于上下文无关，误差不会被传递；它的劣势也是很清晰的，一方面是无法隐藏明文的模式，另一方面攻击者可以直接对明文进行主动攻击。</p><p>为了增强ECB模式的安全性，CBC模式被引入进来。CBC全称是密码分组链接（CBC，Cipher-block chaining）模式。在CBC模式下，每个明文块需要先与前一个密文块进行异或（xor），然后再进行加密，因此每个密文块都依赖于它前面的所有明文块。那么初始化向量又是在何处被引入的呢？为了保证每条消息的唯一性，在第一个明文块会直接与初始化向量进行异或。用数学语言来表述如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cipher_text_0 = IV</span></div><div class="token-line"><span class="token plain">    cipher_text_i = E_k{plain_text_i XOR cipher_text_{i-1}}</span></div></pre></div><p>如果CBC模式下的初始化向量发生重复使用、全0设置等情况，就会使同样的明文产生同样的密文结果；即使初始化向量未发生重用，对于攻击者来说密文仍然是可预测的，这依然会使加密算法在面对选择明文攻击时的安全性大大降低。</p><p>如下代码使用CBC模式进行加密，但在编码过程中将初始化向量设置为全0，这就导致密文更加容易预测，并且可能会面临字典攻击等安全威胁：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public class Cipher {</span></div><div class="token-line"><span class="token plain">        public static void main() {</span></div><div class="token-line"><span class="token plain">            byte[] plain_text = &quot;Hello World!&quot;.getBytes();</span></div><div class="token-line"><span class="token plain">            byte[] iv = {</span></div><div class="token-line"><span class="token plain">                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00</span></div><div class="token-line"><span class="token plain">            };</span></div><div class="token-line"><span class="token plain">            KeyGenerator kg = KeyGenerator.getInstace(&quot;DES&quot;);</span></div><div class="token-line"><span class="token plain">            kg.init(56);</span></div><div class="token-line"><span class="token plain">            SecretKey key = kg.generateKey();</span></div><div class="token-line"><span class="token plain">            Cipher cipher = Cipher.getInstace(&quot;DES/CBC/PKCS5Padding&quot;);</span></div><div class="token-line"><span class="token plain">            IvParameterSpec ips = new IvParameterSpec(iv);</span></div><div class="token-line"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key, ips);</span></div><div class="token-line"><span class="token plain">            // ...</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p><strong>不安全的Padding</strong></p><p>许多加密算法都支持padding机制，一方面padding是为了补全明文，使其满足加密算法的格式要求；另一方面在padding机制产生作用后，明文将更难以预测，攻击者的攻击复杂度也会相应提高。以下是一种典型的错误示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">public Cipher getRSACipher() {</span></div><div class="token-line"><span class="token plain">        Cipher rsa = null;</span></div><div class="token-line"><span class="token plain">        try {</span></div><div class="token-line"><span class="token plain">            rsa = javax.crypto.Cipher.getInstance(&quot;RSA/NONE/NoPadding&quot;);</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        catch (Exception e) {</span></div><div class="token-line"><span class="token plain">            // ...</span></div><div class="token-line"><span class="token plain">        }</span></div><div class="token-line"><span class="token plain">        return rsa;</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><h2 id="案例实战"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#案例实战"><span class="icon icon-link"></span></a>案例实战</h2><p>通过一系列典型的安全风险场景，相信你对密码安全风险已经有了更加深刻的理解。接下来我们从两个更为复杂的实战案例出发，看看它在实际应用中又能给我们什么启发。</p><h3 id="数字签名伪造"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#数字签名伪造"><span class="icon icon-link"></span></a>数字签名伪造</h3><p>我们知道数字签名是互联网信任体系的根基，那么数字签名是否一定是可信的呢？为了寻找答案，我们要站在攻击者的视角来审视整个体系。</p><p>设想一种场景，在这种场景中攻击者试图执行一次签名诈骗攻击。首先攻击者准备了一份正常的合同m，以及一份伪造的合同m_fake，在不改变合同原本意义的情况下，通过插入逗号、空行、空格、同义词替换等行为，攻击者可以生成一系列以m和m_fake为原型的合同变体。攻击者了解在合同签署过程中使用的签名函数是f()，并通过运算在所有合同变体中找到了f(m) = f(m_fake)，于是攻击者可以将m带给合作方签名。在签名完成后，攻击者可以将签名取下并附到m_fake上，以此来证明合作方签署了m_fake合同。</p><p>再设想一种场景，我们都知道在下载软件安装包时，最好的情况是去官网下载，一方面是来源更可信，另一方面是官网同时也会披露对应安装包的MD5值供用户验证。那么如果攻击者通过碰撞的方式，制造出了一个恶意应用程序，同时该恶意程序的MD5值与官方安装包一致，就可能会导致用户错误地安装恶意程序，从而被攻击者控制。</p><p>通过这两种场景我们会发现，<strong>数字签名也未必可信</strong>。目前技术的快速发展，使得数字签名的伪造成为可能，虽然这种攻击方式的门槛仍然较高，但随着算力和算法的发展，该攻击方式的实施成本会进一步降低，这也是为什么我们需要不断探索强度更高的密码算法。</p><h3 id="hash碰撞与生日攻击"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#hash碰撞与生日攻击"><span class="icon icon-link"></span></a>HASH碰撞与生日攻击</h3><p>HASH碰撞在数学上有一个原型叫“生日攻击”，问题是“一个班级需要有多少人，才能保证每个同学的生日都不一样？”。这里我先直接说答案，你肯定会十分吃惊，如果要求出现相同生日的同学概率不超过5%，那么这个班只能有7个人；如果概率是50%，那么这个班只需要23个人。</p><p>如果按照HASH碰撞的角度来理解，哈希值的空间范围是365，只需要计算23个哈希就有50%的概率出现碰撞。接下来我们就以50%为标准，来判断通用意义上HASH碰撞的可行性。</p><p><strong>数学推导</strong></p><p>这里我们仍然以生日攻击为例，来推导数学公式。如果所有人的生日都不相同，那么意味着每个同学需要在选择自己生日时，排除已经被选择掉的天数，在剩余的日期中做出选择。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">p(n) = 1 · (1-1/365) · (1-2/365) · ... · (1-(n-1)/365)</span></div></pre></div><p>参考泰勒公式：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">e^x = 1 + x + x^2/2 + x^3/6 + ...</span></div><div class="token-line"><span class="token plain">    在x很小的情况下 -&gt; e^x ≈ 1 + x</span></div></pre></div><p>将泰勒公式带入p(n)：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">p(n) ≈ 1 · e^(-1/365) · (-2/365) ··· (-(n-1)/365)</span></div><div class="token-line"><span class="token plain">    = e^(-n(n-1)/730)</span></div></pre></div><p>进一步将p(n)通用化，并将结果从不碰撞转换为碰撞的概率：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">p(n,h) = 1 - e^(-n(n-1)/2h)</span></div></pre></div><p>进行简单的数学变换：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">n(p,h) = (2h·ln(1/(1-p)))^1/2</span></div></pre></div><p>实际应用中，暂时我们以50%为标准，将0.5代入p：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">n(0.5,H) = 1.1774 · (h ^ 1/2)</span></div></pre></div><p><strong>抽象理解和安全验证边界</strong></p><p>从抽象层面来看，生日攻击的理念类似于以空间换时间的攻击方式。主要原因是生日攻击的目标一般是HASH碰撞，而HASH计算的本质是将近乎无限的输入映射到定长或者有限长的hash串，这就注定了多对一的映射关系。因此，<strong>必然存在两个输入M1和M2能够满足HASH(M1)=HASH(M2)，这其中的M1和M2就是我们定义的HASH碰撞攻击结果</strong>。</p><p>尤其值得注意的是，这里我们探讨的HASH碰撞与生日攻击，没有利用任何HASH函数内部的实现机制，因此这种攻击是具有通用型的，而防御方式也相对简单，只需要增加HASH的长度，提高攻击者的计算成本即可。</p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#总结"><span class="icon icon-link"></span></a>总结</h2><p>这节课我们学习了密码学相关的知识。</p><p>古代战争中使用的密令、密码本等都是密码学的一种缩影，它们大都可以划分到古典密码学分支。在现代密码学分支出现之前，古典密码学依靠加密算法的保密性，发挥了巨大的作用，并且诞生了以凯撒密码、维吉尼亚密码为首的一系列经典的替换式密码以及位移式密码算法。</p><p>随着算法研究的不断深入以及计算机算力的增长，经典密码学的安全性难以得到保障，于是诞生了现代密码学分支。在现代密码学分支中，根据加密/解密密钥是否相同又可以划分为对称加密算法与非对称加密算法，其中DES、AES、RC4等都是知名的对称加密算法，而RSA、椭圆曲线加密等都是知名的非对称加密算法。</p><p>在Web应用开发中，我们既会面临密码学相关技术的工程化风险，包括硬编码密钥、随机值重用、使用不安全的算法、可预测的初始化向量以及Padding相关的安全问题；也会面临理论层面比如HASH值空间碰撞风险。这些都需要我们了解并熟悉加密算法的原理，这样才能够很好的驾驭这架复杂又强大的机器。</p><p>相信通过本节课的学习，你已经构建了清晰宏观的密码学视角，在面对特定安全场景时能够处理得安全又不失优雅。密码学是一个快速发展的数学分支，深入地了解其中原理一定能够帮助你构建更加强大、安全、可靠的应用系统！</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/04#思考题"><span class="icon icon-link"></span></a>思考题</h2><ol><li>你可以尝试使用卡西斯基试验破解维吉尼亚密码吗？</li><li>你可以尝试计算我们日常使用的HASH能够抵御多少量级的碰撞攻击吗？</li></ol><p>欢迎在评论区留下你的思考，我们下节课再见。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/docs/web漏洞挖掘实战/03.加密失败/04.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">5/2/2022 10:56:59</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog/umi.js"></script>
  </body>
</html>
