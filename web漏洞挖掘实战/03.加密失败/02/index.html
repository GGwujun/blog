<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog/umi.css" />
    <script>
      window.routerBase = "/blog";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>07｜弱编码：程序之间的沟通语言安全吗？</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/web漏洞挖掘实战/03.加密失败/02" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></span><span>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></span><span>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></span><span>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></span><span>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></span><span>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></span><span>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></span><span>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>计算机基础<ul><li><a href="/blog/编译原理之美">编译原理之美</a></li><li><a href="/blog/编译原理实战">编译原理实战</a></li><li><a href="/blog/深入浅出计算机组成原理">深入浅出计算机组成原理</a></li><li><a href="/blog/详解http">详解http</a></li><li><a href="/blog/计算机网络通关29讲">计算机网络通关29讲</a></li><li><a href="/blog/网络排查案例课">网络排查案例课</a></li><li><a href="/blog/linux操作系统">linux操作系统</a></li><li><a href="/blog/linux性能优化实战">linux性能优化实战</a></li><li><a href="/blog/程序员数学基础">程序员数学基础</a></li><li><a href="/blog/趣谈网络协议">趣谈网络协议</a></li><li><a href="/blog/操作系统实战">操作系统实战</a></li><li><a href="/blog/软件工程之美">软件工程之美</a></li><li><a href="/blog/sql必知必会">sql必知必会</a></li><li><a href="/blog/操作系统实战45讲">操作系统实战45讲</a></li><li><a href="/blog/网络编程实战">网络编程实战</a></li></ul></li><li>算法<ul><li><a href="/blog/常用算法25讲">常用算法25讲</a></li><li><a href="/blog/数据结构与算法之美">数据结构与算法之美</a></li><li><a href="/blog/业务开发算法50讲">业务开发算法50讲</a></li><li><a href="/blog/动态规划面试宝典">动态规划面试宝典</a></li></ul></li><li>前端开发<ul><li><a href="/blog/浏览器工作原理与实践">浏览器工作原理与实践</a></li><li><a href="/blog/新时代产品经理进阶之路">新时代产品经理进阶之路</a></li><li><a href="/blog/全栈工程师修炼指南">全栈工程师修炼指南</a></li><li><a href="/blog/flutter核心技术与实战">flutter核心技术与实战</a></li><li><a href="/blog/java-script核心原理解析">java-script核心原理解析</a></li><li><a href="/blog/说透低代码">说透低代码</a></li><li><a href="/blog/nodejs应用开发实战">nodejs应用开发实战</a></li><li><a href="/blog/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog/reactnative新架构实战课">reactnative新架构实战课</a></li><li><a href="/blog/正则表达式入门">正则表达式入门</a></li><li><a href="/blog/重学前端">重学前端</a></li><li><a href="/blog/serverless入门课">serverless入门课</a></li><li><a href="/blog/type-script入门实战笔记">type-script入门实战笔记</a></li><li><a href="/blog/图解googlev8">图解googlev8</a></li><li><a href="/blog/vue3源码分析">vue3源码分析</a></li><li><a href="/blog/玩转Vue3全家桶">玩转Vue3全家桶</a></li><li><a href="/blog/webassembly入门">webassembly入门</a></li><li><a href="/blog/手把手带你写一个Web框架">手把手带你写一个Web框架</a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/跟月影学可视化">跟月影学可视化</a></li><li><a href="/blog/搞定音频技术">搞定音频技术</a></li><li><a href="/blog/攻克视频技术">攻克视频技术</a></li></ul></li><li>前端工程化<ul><li><a href="/blog/logger">logger</a></li><li><a href="/blog/webpack">webpack</a></li><li><a href="/blog/webpackChain">webpackChain</a></li></ul></li><li>前端性能优化<ul><li><a href="/blog/react性能调优">react性能调优</a></li></ul></li><li>软件测试<ul><li><a href="/blog/全链路压测实战30讲">全链路压测实战30讲</a></li><li><a href="/blog/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog/自动化测试高手课">自动化测试高手课</a></li><li><a href="/blog/软件测试52讲">软件测试52讲</a></li></ul></li><li>面试<ul><li><a href="/blog/面试现场">面试现场</a></li></ul></li><li>杂谈<ul><li><a href="/blog/超级访谈对话张雪峰">超级访谈对话张雪峰</a></li><li><a href="/blog/Git实战手册">Git实战手册</a></li><li><a href="/blog/NodeJS">NodeJS</a></li><li><a href="/blog/ReactJS">ReactJS</a></li><li><a href="/blog/UI设计">UI设计</a></li><li><a href="/blog/webpack4系列教程">webpack4系列教程</a></li><li><a href="/blog/前端知识体系">前端知识体系</a></li><li><a href="/blog/剑指offer刷题笔记">剑指offer刷题笔记</a></li><li><a href="/blog/思考与成长">思考与成长</a></li><li><a href="/blog/设计模式手册">设计模式手册</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog/web漏洞挖掘实战">web漏洞挖掘实战</a></li><li><a href="/blog/web漏洞挖掘实战/01.课前必读">01.课前必读</a><ul><li><a href="/blog/web漏洞挖掘实战/01.课前必读/01"><span>开篇词｜从黑客的视角找漏洞，从安全的角度优雅coding</span></a></li><li><a href="/blog/web漏洞挖掘实战/01.课前必读/02"><span>导读｜解读OWASP Top10 2021</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制">02.失效的访问控制</a><ul><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/01"><span>01｜失效的访问控制：攻击者如何获取其他用户信息？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/02"><span>02｜路径穿越：你的Web应用系统成了攻击者的资源管理器？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/03"><span>03 | 敏感数据泄露：攻击者如何获取用户账户？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/04"><span>04｜权限不合理：攻击者进来就是root权限？</span></a></li><li><a href="/blog/web漏洞挖掘实战/02.失效的访问控制/05"><span>05｜CSRF：为什么用户的操作他自己不承认？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战/03.加密失败">03.加密失败</a><ul><li><a href="/blog/web漏洞挖掘实战/03.加密失败/01"><span>06｜加密失败：使用了加密算法也会被破解吗？</span></a></li><li><a aria-current="page" class="active" href="/blog/web漏洞挖掘实战/03.加密失败/02"><span>07｜弱编码：程序之间的沟通语言安全吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/03"><span>08｜数字证书：攻击者可以伪造证书吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/04"><span>09｜密码算法问题：数学知识如何提高代码可靠性？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/05"><span>10｜弱随机数生成器：攻击者如何预测随机数？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/06"><span>11｜忘记加“盐”：加密结果强度不够吗？</span></a></li><li><a href="/blog/web漏洞挖掘实战/03.加密失败/07"><span>大咖助场｜数字证书，困境与未来</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/04.注入">04.注入</a><ul><li><a href="/blog/web漏洞挖掘实战/04.注入/01"><span>12｜注入（上）：SQL注入起手式</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/02"><span>13｜注入（下）：SQL注入技战法及相关安全实践</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/03"><span>14｜自动化注入神器（一）：sqlmap的设计思路解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/04"><span>15｜自动化注入神器（二）：sqlmap的设计架构解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/05"><span>16｜自动化注入神器（三）：sqlmap的核心实现拆解</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/06"><span>17｜自动化注入神器（四）：sqlmap的核心功能解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/07"><span>18 | 命令注入：开发的Web应用为什么成为了攻击者的bash？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/08"><span>19 | 失效的输入检测（上）：攻击者有哪些绕过方案？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/09"><span>20 | 失效的输入检测（下）：攻击者有哪些绕过方案？</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/10"><span>21｜XSS（上）：前端攻防的主战场</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/11"><span>22｜XSS（中）：跨站脚本攻击的危害性</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/12"><span>23｜XSS（下）：检测与防御方案解析</span></a></li><li><a href="/blog/web漏洞挖掘实战/04.注入/13"><span>24｜资源注入：攻击方式为什么会升级？</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划">05.春节特别策划</a><ul><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/01"><span>春节策划（一）｜ 视频课内容精选：Web渗透测试工具教学</span></a></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/02"><span>春节策划（二） ｜ 给你推荐4本Web安全图书</span></a></li><li><a href="/blog/web漏洞挖掘实战/05.春节特别策划/03"><span>春节策划（三） | 一套测试题，看看对课程内容的掌握情况</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计">06.不安全的设计</a><ul><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/01"><span>25｜业务逻辑漏洞：好的开始是成功的一半</span></a></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/02"><span>26｜包含敏感信息的报错：将安全开发标准应用到项目中</span></a></li><li><a href="/blog/web漏洞挖掘实战/06.不安全的设计/03"><span>27｜用户账户安全：账户安全体系设计方案与实践</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误">07.安全配置错误</a><ul><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/01"><span>28｜安全配置错误：安全问题不只是代码安全</span></a></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/02"><span>29｜Session与Cookie：账户体系的安全设计原理</span></a></li><li><a href="/blog/web漏洞挖掘实战/07.安全配置错误/03"><span>30｜HTTP Header安全标志：协议级别的安全支持</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲">08.其他安全风险串讲</a><ul><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/01"><span>31｜易受攻击和过时的组件：DevSecOps与依赖项安全检查</span></a></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/02"><span>32｜软件和数据完整性故障：SolarWinds事件的幕后⿊⼿</span></a></li><li><a href="/blog/web漏洞挖掘实战/08.其他安全风险串讲/03"><span>33｜SSRF：穿越边界防护的利刃</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇">09.综合实战篇</a><ul><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/01"><span>34｜Crawler VS Fuzzing：DAST与机器学习</span></a></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/02"><span>35｜自动化攻防：低代码驱动的渗透工具积累</span></a></li><li><a href="/blog/web漏洞挖掘实战/09.综合实战篇/03"><span>36｜智能攻防：构建个性化攻防平台</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/10.结束语">10.结束语</a><ul><li><a href="/blog/web漏洞挖掘实战/10.结束语/01"><span>结束语｜无畏前行</span></a></li><li><a href="/blog/web漏洞挖掘实战/10.结束语/02"><span>期末测试｜来赴一场满分之约吧！</span></a></li></ul></li><li><a href="/blog/web漏洞挖掘实战/summary">web漏洞挖掘实战</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="编码" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/02#编码"><span>编码</span></a></li><li title="案例实战" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/02#案例实战"><span>案例实战</span></a></li><li title="总结" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/02#总结"><span>总结</span></a></li><li title="思考题" data-depth="2"><a href="/blog/web漏洞挖掘实战/03.加密失败/02#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="07弱编码程序之间的沟通语言安全吗"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#07弱编码程序之间的沟通语言安全吗"><span class="icon icon-link"></span></a>07｜弱编码：程序之间的沟通语言安全吗？</h1><p>你好，我是王昊天。</p><p>进入了加密失败这个大篇章，我们的第一个话题就是——弱编码。</p><p>如果你想了解什么是编码，那么不妨想象一下双十一购物的场景吧。</p><p>我们通过电商平台购买了许多零食、家居用品以及二次元手办，一时下单一时爽，一直下单一直爽，于是全国人民都在买买买。这个时候电商平台的难题来了，各式各样的商品要如何送到每个人手里呢？总不能每一种商品打造一条运输线路。</p><p>于是快递出现了，通过对不同类型的商品进行方形硬纸盒的封装，既保护了商品在运输中的完整性，又保证了传输的便捷性。</p><p>这就是编码的典型场景，在服务端与客户端传输数据的过程中，我们无法确认传输的内容中是否包含传输协议不支持的内容，因此在数据传输之前我们希望通过编码的方式将传输数据进行规范化。</p><p>这里一定要注意，编码是不具备保密性的。就像快递小哥只是不想知道包装里面是什么东西，如果他想知道的话，应该是一件不难的事情。</p><h2 id="编码"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#编码"><span class="icon icon-link"></span></a>编码</h2><p>我们来看看维基百科是如何定义编码的：</p><blockquote><p>编码是信息从一种形式或格式转换为另一种形式的过程；解码则是编码的逆过程。</p></blockquote><p>作为一名优雅的开发工程师，或者是一名“大黑客”，掌握多种编码特征都是非常重要的，这一讲，我就来带你进入编码的世界遨游一番。</p><h4 id="字符编码"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#字符编码"><span class="icon icon-link"></span></a>字符编码</h4><p>字符编码是把字符集中的字符映射为指定集合中的某一个对象，以便文本在计算机中存储或者在网络之间传递。在计算机发展的早期，ASCII这样的字符集是字符编码的标准形式，但是这些字符集有着很大的局限性，比如只适用于英文场景等，于是人们开发了许多方法来扩展它们，编码的类型也逐步丰富：</p><ul><li>早期标准：ASCII、EBCDIC</li><li>西欧标准：ISO-8859-1、ISO-8859-5、ISO-8859-6、ISO-8859-7、ISO-8859-11、ISO-8859-15等</li><li>DOS字符集：CP437、CP737、CP850等</li><li>Windows字符集：Windows-1250、Windows-1251、Windows-1252等</li><li>中文：GB2312、GBK等</li><li>Unicode：Unicode、UTF-7、UTF-8、UTF-16、UTF-32等</li></ul><p>这些字符集有各自的诞生意义和应用场景，在我们日常工作中会经常遇到其中的某一些，这里我们选取几个有代表性的字符集来深入研究。</p><p><strong>ASCII</strong><br/>ASCII（American Standard Code for Information Interchange，美国信息交换标准代码）是最常用的编码，来表示字母、数字以及常用符号。如果你正在使用Mac或者Linux类型系统，可以直接使用如下命令来查看所有的ASCII字符：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">&gt; man ascii</span></div><div class="token-line"><span class="token plain">    ASCII(7)             BSD Miscellaneous Information Manual             ASCII(7)</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    NAME</span></div><div class="token-line"><span class="token plain">         ascii -- octal, hexadecimal and decimal ASCII character sets</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    DESCRIPTION</span></div><div class="token-line"><span class="token plain">         The octal set:</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">         000 nul  001 soh  002 stx  003 etx  004 eot  005 enq  006 ack  007 bel</span></div><div class="token-line"><span class="token plain">         010 bs   011 ht   012 nl   013 vt   014 np   015 cr   016 so   017 si</span></div><div class="token-line"><span class="token plain">         020 dle  021 dc1  022 dc2  023 dc3  024 dc4  025 nak  026 syn  027 etb</span></div><div class="token-line"><span class="token plain">         030 can  031 em   032 sub  033 esc  034 fs   035 gs   036 rs   037 us</span></div><div class="token-line"><span class="token plain">         040 sp   041  !   042  &quot;   043  #   044  $   045  %   046  &amp;   047  &#x27;</span></div><div class="token-line"><span class="token plain">         050  (   051  )   052  *   053  +   054  ,   055  -   056  .   057  /</span></div><div class="token-line"><span class="token plain">         060  0   061  1   062  2   063  3   064  4   065  5   066  6   067  7</span></div><div class="token-line"><span class="token plain">    ...</span></div></pre></div><p>ASCII的一个字符占8位（bit），第一位总是0，这种情况下能够支持2的7次方也就是128个字符，其中00100000~01111110之间都是可打印字符。</p><p><strong>GB 2312 &amp; GBK</strong><br/>对于中文来说，汉字博大精深，区区128个字符肯定是不能够满足我们的需求的，于是就诞生了中文编码。考虑到8位编码是远远不够的，并且需要与ASCII编码兼容，GB2312编码方法应运而生，它具有以下特征：</p><ol><li>使用两个8位来进行编码；</li><li>0～127编号的字符使用ASCII标准编码；</li><li>两个大于127的字符连在一起时表示一个汉字，前一个称为高字节，后一个称为低字节。</li></ol><p>我们通常所说的全角字符就是双字节字符，而单字节字符就是半角字符。但后来发现GB2312的编码仍然不具备表示所有汉字的能力，于是我们就对上述第3个条件进行了优化，诞生了GBK编码，这里K表示“扩展”。优化后第三点特征表示为：</p><ol start="3"><li>允许低字节使用0~127的字符，仅凭借高字节判断是否为中文。</li></ol><p>GB2312编码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    \xC4\xE3\xBA\xC3\x68\x65\x6C\x6C\x6F\x31\x32\x33</span></div></pre></div><p>常见的GBK编码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    \xC4\xE3\xBA\xC3\x68\x65\x6C\x6C\x6F\x31\x32\x33</span></div></pre></div><p><strong>Unicode &amp; UTF-8</strong><br/>对于全球各国的文字来说，ASCII的字符集已经不能满足使用了，对于这个问题ISO提出了一个囊括全球所有文字的终极解决方案：Unicode。它最初规定所有的字符都是用两个字节来表示，这个版本就是UTF-16；但是后面发现仍然不够使用，于是扩展到四个字节，这个版本就是UTF-32。目前最新的Unicode已经支持了emoji表情，让我们的文字语言更加丰富且生动。</p><p>但是所有的字符都使用Unicode来存储是否会增大存储成本呢？毕竟ASCII单字符只占用1个字节，GBK也仅仅只占用2个字节，如果全部使用UTF-32来表示，就意味着至少2倍存储空间的膨胀，这时另一个新的编码算法的出现解决了这个问题，并成为了在coding过程中广泛使用的编码类型——UTF-8。</p><p>UTF-8是一种变长编码，比如对于ASCII码它就用1个字节表示，面对其他类型的编码就在前面加一个高位字节。通过这种方式，它在普遍英文coding但是携带中文注释的环境中就显得非常适合了。</p><p>Unicode编码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    \x00004F60\x0000597D\x00000068\x00000065\x0000006C\x0000006C\x0000006F\x00000031\x00000032\x00000033</span></div></pre></div><p>TF-8编码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    \xE4BDA0\xE5A5BD\x68\x65\x6C\x6C\x6F\x31\x32\x33</span></div></pre></div><h4 id="程序编码"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#程序编码"><span class="icon icon-link"></span></a>程序编码</h4><p><strong>URL 编码</strong><br/>URL编码又称百分号编码，因为它的编码特征是以%开头，是不是很形象？它主要用于统一资源定位符（URL）的编码，也适用于统一资源标识符（URI）的编码。URI所允许的字符主要分为保留字符和未保留字符两类：保留字符主要是那些具有特殊含义的字符，如<code>! * &amp;</code>等；未保留字符，主要指不具备特殊含义的字符，如<code>A B C</code>等。</p><p>如果一个保留字符在上下文中是有意义的，并且需要在URI中按照内容格式进行展示，那么该字符就要使用百分号编码。百分号编码首先会把字符的ASCII值表示为两个16进制的数字，然后在其前面放置转义字符<code>%</code>；对于非ASCII字符则先转换为UTF-8字节序，然后再放置转义字符<code>%</code>。</p><p>UTF-8格式百分号编码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    %E4%BD%A0%E5%A5%BDhello123</span></div></pre></div><p><strong>Base64 编码</strong><br/>Base64是一种用64个字符来表示二进制数据的方法。由于 64 = 2 ^ 6，因此每6位可映射到一个可打印字符，又由于每6位等于四分之三字节，因此可以简单理解为每四分之三字节映射到一个新的字节，这样也就很容易能计算出base64的编码膨胀率。Base64通常用于表示、传输以及存储二进制数据。</p><p>简单思考一下Base64的规则，会发现一个有趣的事情：如果要编码的字节数不能被3整除，那么就会无法进行Base64编码。所以完整的Base64编码规则是先使用“0”将不足的字节数在末尾补足，使其能够被3整除，然后再进行Base64的编码。增加的字节数在末尾用等同数量的“=”进行标记。</p><p>base64编码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">你好hello123</span></div><div class="token-line"><span class="token plain">    5L2g5aW9aGVsbG8xMjM=</span></div></pre></div><h4 id="编码-vs-加密"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#编码-vs-加密"><span class="icon icon-link"></span></a>编码 v.s. 加密</h4><p>通过对编码的一些讨论，我们已经了解到编码的一些特性，这里我们将编码与我们上节课学过的加密做一下简单的对比，看看它们有什么相同和不同。</p><ul><li><p>编码与加密都是可逆运算<br/>通过对编码数据进行解码即可恢复原始数据；对加密数据解密我们同样可以获得原始数据。</p></li><li><p>编码只需要1个输入，而加密需要2个输入<br/>选定编码函数之后，我们只需要选择待编码数据即可；而对于加密函数，除了待加密数据以外，我们还需要选择加密密钥。</p></li><li><p>编码的目的是方便数据交互，加密的目的是保护数据交互<br/>通过编码可以将数据在不同协议系统之间进行流转，目的在于可用性；通过加密可以将数据安全地传输，目的在于机密性。</p></li></ul><h4 id="编码-vs-转义"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#编码-vs-转义"><span class="icon icon-link"></span></a>编码 v.s. 转义</h4><p>通常，转义是很容易与编码混淆的概念。因为与加密相比，转义同时具备只需要一个输入，可逆运算两个条件。但是转义与编码的使用场景是不同的，即它们的“目的”不同。</p><p>与编码便于数据交互的目的不同，转义通常有两个目的：</p><ol><li>编码一个语句上的实体，比如设备命令或者无法被打印字符直接表示的特殊数据；</li><li>作为特殊字符引用，主要用于表示无法在当前上下文中以可打印形态录入的字符，比如回车符。</li></ol><p>转义字符开头的字符序列被叫做转义序列，通常一个转义字符并没有它自己的意思，因此转义序列一般具有2个或更多字符。</p><p>通过判断二者的目的，我们可以很容易对编码和转义进行区分。</p><h2 id="案例实战"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#案例实战"><span class="icon icon-link"></span></a>案例实战</h2><p>了解了编码的基础知识，接下来我们一起来研究几个与编码相关的安全问题。这几个实战案例都已经搭建在<a target="_blank" rel="noopener noreferrer" href="https://mituan.zone/#/">MiTuan<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，搜索【编码漏洞合集】就可以直接使用。</p><h4 id="宽字节注入"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#宽字节注入"><span class="icon icon-link"></span></a>宽字节注入</h4><p>启动靶机之后，我们可以直接看到一个支持HTTP GET请求的页面，页面上告诉了我们这个示例漏洞内部的代码逻辑：程序内部通过addslashes函数，对用户GET请求中的str参数进行处理，然后拼接到SQL语句中，同时页面上也将打印实际执行的SQL语句，方便我们对漏洞利用过程进行调试。</p><p><img src="https://static001.geekbang.org/resource/image/af/30/af7fe868188043f9eyyf9da1eb536830.png?wh=1920x1033" alt="图片"/></p><p>那么接下来我们就开始尝试利用这个潜在的SQL注入漏洞。</p><p>第一步是寻找注入点。由于这个页面仅支持str这一个参数的输入，因此我们可以判断注入点应该就在这里。我们可以先尝试一些常规的注入方式来看一下页面的处理结果。比如，通过尝试<code>1</code> 和<code>1&#x27;</code>这两种不同的输入，我们发现经过addslashes函数的处理，SQL语句并没有被闭合，这种情况下我们是不能执行注入的。</p><p>虽然<code>1&#x27;</code>这个参数并没有达到让SQL语句闭合的目标，但是这一次SQL语句的构造可以给我们一些新的启发：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">select * from user where user=&#x27;1\&#x27;&#x27;</span></div></pre></div><p>通过这个完整的SQL语句，我们可以发现 <code>1</code> 与 <code>\</code> 是连续字符，这种情况下如果将 <code>1</code> 修改为特殊字符，使其能够通过编码组合与 <code>\</code> 组成新的字符，我们就能实现编码绕过。</p><p>第二步就是实践我们的想法，找出一个能与 <code>\</code> 组成新的字符的特殊字符。</p><p>通过编码工具，可以得知 <code>\</code> 的GBK编码是 <code>\x5C</code> ，经过刚刚的学习我们知道了GBK编码中汉字编码的特征，所以我们只需要选取一个合适的高位字节即可。比如，这里我选择了 <code>\xC4</code> ，通过编码工具我们可以知道 <code>\xC4\x5C</code> 是汉字 <code>腬</code> ，因此拼接完成之后的完整内容 <code>\xC4\x5C\x26\x23\x33\x39\x3B</code> 即可满足要求。</p><p>通过这些操作，我们将 <code>1</code> 替换为 <code>%C4</code> 即可实现第一步中我们的编码绕过设想。</p><p>第三步很简单，将 <code>%C4</code> 作为参数输入GET请求即可。要注意GET请求中的str参数需要应用URL编码格式，而想要得到GB2312的URL编码，只需在前面增加“%”符号即可。因此将 <code>%C4</code> 与 <code>&#x27;</code> 一起拼接，得到的完整参数是 <code>%C4%27</code> 。</p><p>将我们构造的完整参数输入浏览器地址栏进行访问，可以得到页面的输出：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">select * from user where user=&#x27;腬&#x27;&#x27;</span></div></pre></div><p>接下来可以进一步增加其他SQL控制字符进行注入动作：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">str=%C4%27%23</span></div><div class="token-line"><span class="token plain">    select * from user where user=&#x27;腬&#x27;#&#x27;</span></div></pre></div><h4 id="cve-2021-42574"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#cve-2021-42574"><span class="icon icon-link"></span></a>CVE-2021-42574</h4><p>这是一个由剑桥大学的研究人员发现的漏洞，它由编码问题引起，常见于供应链污染类型漏洞。在介绍漏洞原理之前我们先来和它进行一个亲密接触：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#include &lt;stdio.h&gt;</span></div><div class="token-line"><span class="token plain">    #include &lt;stdbool.h&gt;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    int main() {</span></div><div class="token-line"><span class="token plain">        bool isAdmin = false;</span></div><div class="token-line"><span class="token plain">        /* begin admins only */ if (isAdmin) {</span></div><div class="token-line"><span class="token plain">            printf(&quot;You are an admin.\n&quot;);</span></div><div class="token-line"><span class="token plain">        /* end admins only */ }</span></div><div class="token-line"><span class="token plain">        return 0;</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>上述C代码逻辑十分简单，核心逻辑是判定isAdmin的bool类型并执行相应动作。按照isAdmin的初始化数值，函数应该直接进入return逻辑，不产生任何输出。这里我们直接运行：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$&gt; clang program.c &amp;&amp; ./a.out</span></div><div class="token-line"><span class="token plain">    You are an admin.</span></div></pre></div><p>神奇的事情出现了，尽管isAdmin的值为False，程序仍然执行了if判断分支内部的函数。</p><p>聪明的你知道这是为什么吗？</p><p>其实奥秘就在“控制字符”上。通过使用Unicode控制字符，我们可以将编码的顺序进行视觉效果上的反转。比如上面的示例代码，其真实代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#include &lt;stdio.h&gt;</span></div><div class="token-line"><span class="token plain">    #include &lt;stdbool.h&gt;</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    int main() {</span></div><div class="token-line"><span class="token plain">        bool isAdmin = false;</span></div><div class="token-line"><span class="token plain">        /*RLO } LRIif (isAdmin)PDI LRI begin admins only */</span></div><div class="token-line"><span class="token plain">            printf(&quot;You are an admin.\n&quot;);</span></div><div class="token-line"><span class="token plain">        /* end admins only RLO { LRI*/</span></div><div class="token-line"><span class="token plain">        return 0;</span></div><div class="token-line"><span class="token plain">    }</span></div></pre></div><p>可以看到在真实的代码中，if 语句完全被注释符号包裹，根本不存在真实判断逻辑。</p><p>那么为什么Unicode要设置这么恶意的“欺骗性”字符呢？</p><p>其实并非Unicode有恶意，这里我们回顾一下Unicode诞生的原因——囊括全球文字的终极编码方案。人类社会的文化是非常丰富的，以语言文字为例，既有像汉字这样按照从左到右顺序读写的文字，也有像阿拉伯语这样从右到左读写的文字，因此为了满足这种文字应用场景，Unicode提供了影响阅读顺序的控制字符。</p><p>由于近些年供应链污染攻击盛行，一旦黑客入侵软件厂商代码库或者污染了具有广泛应用的开源项目，就会造成巨大的安全威胁。</p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#总结"><span class="icon icon-link"></span></a>总结</h2><p>这节课我们学习了加密失败的另一种安全风险形式——弱编码。</p><p>事实上关于编码的安全问题很多，主要是由于对编码和加密的算法理解有误所致，弱编码仅仅是一个浅层问题的缩影。通过了解编码的本质——信息格式的转换，就可以区分开编码与加密，进而就可以选择合适的使用场景。</p><p>从弱编码这一浅层安全问题入手，这节课我们进一步解读了一些主流的编码标准，让我们可以快速识别数据所属的编码类别：像ASCII占位1个字节，共8bit，能够描述128个字符，适用于英文场景；GB2312与GBK占位2个字节，共16bit，用于中文场景，GBK是GB2312的扩展；Unicode与UTF-8则更为宏大，用于描述全球各国的文字，并且UTF-8具有变长的特征。</p><p>在了解了字符编码的基础上，我们进一步探讨了常见的程序编码：像URL编码，其特征是以%开头，因此又称百分号编码，其编码结果与GBK和UTF-8的原始编码是非常相似的；而Base64编码，其特征是编码结果均为可打印字符，并且编码结果末尾可能存在=符号，主要适用场景是二进制数据的传递；再进一步扩展的话，其他Base编码也有相似之处。</p><p>与编码相关的更多深层次安全问题，是与编码转换以及转义字符处理相关的，因此在实战案例部分我选择了2个漏洞带你深入探究编码安全问题：</p><ol><li>宽字节注入问题，其发生的根源在于数据与命令的结合，但直接导火索是字符处理函数考虑不全，对于编码转换场景未经过严密的处理，产生了编码绕过的后果；</li><li>Unicode字符序列问题，以CVE-2021-42574为例，其发生的根源是IDE在渲染Unicode编码过程中进行了控制字符解析，造成了开发人员理解代码错误引入后门或其他安全威胁。</li></ol><p>通过这节课的学习，我们可以发现编码看似是非程序开发问题，但是涉及的知识和原理非常广泛，同时引入的安全问题由于其逻辑晦涩也不易被发现。因此在coding过程中，深刻理解编码的作用以及程序内部执行过程的编码逻辑十分重要，考虑到编码引入的安全问题相对隐蔽，我们也可以考虑在项目中引入优秀的SAST工具，协助我们发现和定位编码层的安全问题。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog/web漏洞挖掘实战/03.加密失败/02#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>除了这一讲中我们提到了两种编码漏洞，还有一种同形字符编码漏洞，CVE-ID是CVE-2021-42694，你可以自己完成漏洞追踪及分析吗？</p><p>欢迎在评论区留下你的思考，我们下节课再见。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/docs/web漏洞挖掘实战/03.加密失败/02.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">5/2/2022 10:56:59</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog/umi.js"></script>
  </body>
</html>
